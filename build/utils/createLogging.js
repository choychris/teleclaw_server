"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loggingAccess=loggingAccess,exports.loggingSave=loggingSave,exports.loggingRemote=loggingRemote,exports.loggingModel=loggingModel,exports.loggingFunction=loggingFunction;var winston=require("winston");require("winston-papertrail").Papertrail;var winstonLogger=new winston.Logger({levels:{error:0,warn:1,info:2,verbose:3,debug:4,silly:5},colors:{info:"cyan",error:"red"},prettyPrint:!0,colorize:!0});if("development"===process.env.NODE_ENV&&winstonLogger.add(winston.transports.Console),"production"===process.env.NODE_ENV){var winstonPapertrail=new winston.transports.Papertrail({host:"logs.papertrailapp.com",port:process.env.PAPERTRAIL_PORT});winstonLogger=new winston.Logger({levels:{error:0,warn:1,info:2,verbose:3,debug:4,silly:5},colors:{info:"cyan",error:"red"},prettyPrint:!0,colorize:!0,transports:[winstonPapertrail]})}function loggingAccess(e){e.observe("access",function(e,o){var n=null;if(e.query){var i=e.options.accessToken;if(null!=i)n=i.userId;winstonLogger.log("info"," | Access - "+e.Model.modelName+" |","User Id - "+n+" |",e.query)}else{var r=e.options.accessToken;if(null!=r)n=r.userId;winstonLogger.log("info","Access: "+e.Model.modelName,"user id : "+n)}o()})}function loggingSave(e){e.observe("before save",function(e,o){if(e.isNewInstance)o();else if(e.instance){var n={timeStamp:new Date,update:e.instance};winstonLogger.log("info",""+e.Model.modelName,"| Updating Instance |",JSON.stringify(n)),o()}else if(e.data&&void 0!==e.currentInstance){var i={timeStamp:new Date,objectId:e.currentInstance.id,update:e.data};winstonLogger.log("info",""+e.Model.modelName,"| Updating data |",JSON.stringify(i)),o()}else if(e.data){var r={timeStamp:new Date,update:e.data};winstonLogger.log("info",""+e.Model.modelName,"| Updating data |",JSON.stringify(r)),o()}}),e.observe("after save",function(e,o){e.isNewInstance&&winstonLogger.log("info",""+e.Model.modelName,"| Create Success  |",JSON.stringify(e.instance)),o()})}function loggingRemote(e,s){e.beforeRemote(s,function(e,o,n){var i=void 0,r=e.req.accessToken;if(null!=r){r.id;i=r.userId}var t=e.args.params?e.args.params:e.args;winstonLogger.log("info","Remote: "+s+" | ","user: "+i+" | timeStamp: "+new Date,JSON.stringify(t)),n()})}function loggingModel(e){loggingSave(e)}function loggingFunction(e,o,n,i){winstonLogger.log(void 0===i?"info":i,e,o,n)}